import{ap as e,z as s,_ as a}from"./vendor.ece5be17.js";import{C as l}from"./index.614f054b.js";import{_ as o}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang.aa05cd79.js";import{aa as i,u as r,ay as n,A as t}from"./index.8e60a3c0.js";import{u as c,a as m,L as u,S as d,b as p}from"./useLogin.5ee5275e.js";import{d as g,k as f,r as v,e as y,a2 as _,a3 as b,f as h,ad as x,u as k,E as L,ag as S,F as j,Z as C,J as F}from"./vue-vendor.1938e417.js";const z=g({__name:"MobileForm",setup(g){const z=e.Item,{t:E}=r(),{handleBackLogin:M,getLoginState:R}=c(),{getFormRules:T}=m(),{notification:w,createErrorModal:A}=t(),B=i(),I=f(),O=f(!1),P=v({mobile:"",sms:""}),{validForm:D}=p(I),U=y((()=>k(R)===u.MOBILE));function $(){return e=this,s=null,a=function*(){const e=yield D();if(e)try{O.value=!0;const s=yield B.phoneLogin(F({mobile:e.mobile,captcha:e.sms,mode:"none"}));s&&w.success({message:E("sys.login.loginSuccessTitle"),description:`${E("sys.login.loginSuccessDesc")}: ${s.realName}`,duration:3})}catch(s){w.error({message:E("sys.api.errorTip"),description:s.message||E("sys.api.networkExceptionMsg"),duration:3})}finally{O.value=!1}},new Promise(((l,o)=>{var i=e=>{try{n(a.next(e))}catch(s){o(s)}},r=e=>{try{n(a.throw(e))}catch(s){o(s)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(i,r);n((a=a.apply(e,s)).next())}));var e,s,a}function G(){return n({mobile:P.mobile,smsmode:d.FORGET_PASSWORD})}return(i,r)=>U.value?(_(),b(j,{key:0},[h(o,{class:"enter-x"}),h(k(e),{class:"p-4 enter-x",model:P,rules:k(T),ref_key:"formRef",ref:I},{default:x((()=>[h(k(z),{name:"mobile",class:"enter-x"},{default:x((()=>[h(k(s),{size:"large",value:P.mobile,"onUpdate:value":r[0]||(r[0]=e=>P.mobile=e),placeholder:k(E)("sys.login.mobile"),class:"fix-auto-fill"},null,8,["value","placeholder"])])),_:1}),h(k(z),{name:"sms",class:"enter-x"},{default:x((()=>[h(k(l),{size:"large",class:"fix-auto-fill",value:P.sms,"onUpdate:value":r[1]||(r[1]=e=>P.sms=e),placeholder:k(E)("sys.login.smsCode"),sendCodeApi:G},null,8,["value","placeholder"])])),_:1}),h(k(z),{class:"enter-x"},{default:x((()=>[h(k(a),{type:"primary",size:"large",block:"",onClick:$,loading:O.value},{default:x((()=>[L(S(k(E)("sys.login.loginButton")),1)])),_:1},8,["loading"]),h(k(a),{size:"large",block:"",class:"mt-4",onClick:k(M)},{default:x((()=>[L(S(k(E)("sys.login.backSignIn")),1)])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])],64)):C("",!0)}});export{z as _};
