var e=Object.defineProperty,n=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(n,t,o)=>t in n?e(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,a=(e,n,t)=>new Promise(((o,s)=>{var i=e=>{try{a(t.next(e))}catch(n){s(n)}},r=e=>{try{a(t.throw(e))}catch(n){s(n)}},a=e=>e.done?o(e.value):Promise.resolve(e.value).then(i,r);a((t=t.apply(e,n)).next())}));import{B as l}from"./BasicTable.e3f897c9.js";import{T as u}from"./BasicForm.vue_vue_type_style_index_0_lang.daafa440.js";import"./TableImg.vue_vue_type_style_index_0_lang.bde218ee.js";import{_ as c}from"./UserDrawer.vue_vue_type_script_setup_true_lang.d104976a.js";import{_ as d}from"./UserRecycleBinModal.vue_vue_type_script_setup_true_lang.84895800.js";import{_ as p}from"./PasswordModal.vue_vue_type_script_name_PassWordModal_setup_true_lang.7ffd36c6.js";import{_ as m}from"./UserAgentModal.vue_vue_type_script_setup_true_lang.58e82da2.js";import{J as f}from"./JThirdAppButton.3283ab59.js";import{_}from"./UserQuitAgentModal.vue_vue_type_script_setup_true_name_user-quit-agent-modal_lang.6809b32c.js";import y from"./UserQuitModal.f8b2e19e.js";import{a as g}from"./index.a4c2ac5a.js";import{u as b}from"./useListPage.b9ed7a87.js";import"./index.a6220f15.js";import{n as j,N as v,A as w}from"./index.8e60a3c0.js";import{e as h,s as C}from"./user.data.7a0af023.js";import{o as k,q as S,t as x,v as R,w as M,x as T,y as O}from"./validator.f9ca1444.js";import{d as P,Y as U,a2 as I,a3 as F,f as A,ad as D,E as B,u as z,ab as E,Z as J}from"./vue-vendor.1938e417.js";import"./vendor.ece5be17.js";import"./__commonjsHelpers__.488ed5c2.js";import"./useForm.0379175d.js";import"./useWindowSizeFn.6b4ca4c0.js";import"./BasicModal.cadf9873.js";import"./index.614f054b.js";import"./useCountdown.293f285b.js";import"./JUpload.vue_vue_type_style_index_0_lang.9ab12372.js";import"./index.ea04f0eb.js";import"./areaDataUtil.d2791cdd.js";import"./index.c01929c9.js";import"./useTable.12b47fdb.js";const L=P({name:"system-user"}),q=P((N=((e,n)=>{for(var t in n||(n={}))s.call(n,t)&&r(e,t,n[t]);if(o)for(var t of o(n))i.call(n,t)&&r(e,t,n[t]);return e})({},L),n(N,t({setup(e){const{createMessage:n,createConfirm:t}=w();j();const[o,{openDrawer:s}]=g(),[i,{openModal:r}]=v(),[P,{openModal:L}]=v(),[q,{openModal:N}]=v(),[Q,{openModal:W}]=v(),[X,{openModal:H}]=v(),{prefixCls:K,tableContext:Y,onExportXls:Z,onImportXls:G}=b({designScope:"user-list",tableProps:{title:"用户列表",api:k,columns:h,size:"small",formConfig:{schemas:C},actionColumn:{width:120},beforeFetch:e=>Object.assign({column:"createTime",order:"desc"},e)},exportConfig:{name:"用户列表",url:S},importConfig:{url:x}}),[V,{reload:$,updateTableDataRecord:ee},{rowSelection:ne,selectedRows:te,selectedRowKeys:oe}]=Y;function se(){s(!0,{isUpdate:!1,showFooter:!0,tenantSaas:!1})}function ie(e){return a(this,null,(function*(){s(!0,{record:e,isUpdate:!0,showFooter:!0,tenantSaas:!1})}))}function re(e){return a(this,null,(function*(){s(!0,{record:e,isUpdate:!0,showFooter:!1,tenantSaas:!1})}))}function ae(e){return a(this,null,(function*(){"admin"!=e.username?yield O({id:e.id},$):n.warning("管理员账号不允许此操作！")}))}function le(){return a(this,null,(function*(){let e=z(te).filter((e=>"admin"==e.username));z(e).length>0?n.warning("管理员账号不允许此操作！"):yield R({ids:oe.value},(()=>{oe.value=[],$()}))}))}function ue(){$()}function ce(e){L(!0,{username:e})}function de(e){N(!0,{userName:e})}function pe(e,t){return a(this,null,(function*(){"admin"!=e.username?yield M({ids:e.id,status:t},$):n.warning("管理员账号不允许此操作！")}))}function me(e){let o=te.value.filter((e=>"admin"==e.username));z(o).length>0?n.warning("管理员账号不允许此操作！"):t({iconType:"warning",title:"确认操作",content:"是否"+(1==e?"解冻":"冻结")+"选中账号?",onOk:()=>a(this,null,(function*(){yield M({ids:z(oe).join(","),status:e},$)}))})}function fe(){T()}function _e({isToLocal:e}){e&&$()}function ye(e){return[{label:"编辑",onClick:ie.bind(null,e)}]}function ge(e){return[{label:"详情",onClick:re.bind(null,e)},{label:"密码",onClick:ce.bind(null,e.username)},{label:"删除",popConfirm:{title:"是否确认删除",confirm:ae.bind(null,e)}},{label:"冻结",ifShow:1==e.status,popConfirm:{title:"确定冻结吗?",confirm:pe.bind(null,e,2)}},{label:"解冻",ifShow:2==e.status,popConfirm:{title:"确定解冻吗?",confirm:pe.bind(null,e,1)}},{label:"代理人",onClick:de.bind(null,e.username)}]}return(e,n)=>{const t=U("a-button"),s=U("j-upload-button"),a=U("Icon"),g=U("a-menu-item"),b=U("a-menu"),j=U("a-dropdown");return I(),F("div",null,[A(z(l),{onRegister:z(V),rowSelection:z(ne)},{tableTitle:D((()=>[A(t,{type:"primary",preIcon:"ant-design:plus-outlined",onClick:se},{default:D((()=>[B(" 新增")])),_:1}),A(t,{type:"primary",preIcon:"ant-design:export-outlined",onClick:z(Z)},{default:D((()=>[B(" 导出")])),_:1},8,["onClick"]),A(s,{type:"primary",preIcon:"ant-design:import-outlined",onClick:z(G)},{default:D((()=>[B("导入")])),_:1},8,["onClick"]),A(t,{type:"primary",onClick:fe,preIcon:"ant-design:sync-outlined"},{default:D((()=>[B(" 同步流程")])),_:1}),A(t,{type:"primary",onClick:n[0]||(n[0]=e=>z(r)(!0,{})),preIcon:"ant-design:hdd-outlined"},{default:D((()=>[B(" 回收站")])),_:1}),A(f,{"biz-type":"user","selected-row-keys":z(oe),syncToApp:"",syncToLocal:"",onSyncFinally:_e},null,8,["selected-row-keys"]),z(oe).length>0?(I(),E(j,{key:0},{overlay:D((()=>[A(b,null,{default:D((()=>[A(g,{key:"1",onClick:le},{default:D((()=>[A(a,{icon:"ant-design:delete-outlined"}),B(" 删除 ")])),_:1}),A(g,{key:"2",onClick:n[1]||(n[1]=e=>me(2))},{default:D((()=>[A(a,{icon:"ant-design:lock-outlined"}),B(" 冻结 ")])),_:1}),A(g,{key:"3",onClick:n[2]||(n[2]=e=>me(1))},{default:D((()=>[A(a,{icon:"ant-design:unlock-outlined"}),B(" 解冻 ")])),_:1})])),_:1})])),default:D((()=>[A(t,null,{default:D((()=>[B("批量操作 "),A(a,{icon:"mdi:chevron-down"})])),_:1})])),_:1})):J("",!0)])),action:D((({record:e})=>[A(z(u),{actions:ye(e),dropDownActions:ge(e)},null,8,["actions","dropDownActions"])])),_:1},8,["onRegister","rowSelection"]),A(c,{onRegister:z(o),onSuccess:ue},null,8,["onRegister"]),A(p,{onRegister:z(P),onSuccess:z($)},null,8,["onRegister","onSuccess"]),A(m,{onRegister:z(q),onSuccess:z($)},null,8,["onRegister","onSuccess"]),A(d,{onRegister:z(i),onSuccess:z($)},null,8,["onRegister","onSuccess"]),A(_,{onRegister:z(Q),onSuccess:z($)},null,8,["onRegister","onSuccess"]),A(y,{onRegister:z(X),onSuccess:z($)},null,8,["onRegister","onSuccess"])])}}}))));var N;export{q as default};
