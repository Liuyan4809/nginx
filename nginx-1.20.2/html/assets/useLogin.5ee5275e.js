var e=Object.defineProperty,r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,t=(r,n,o)=>n in r?e(r,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[n]=o,s=(e,r,n)=>new Promise(((o,t)=>{var s=e=>{try{a(n.next(e))}catch(r){t(r)}},i=e=>{try{a(n.throw(e))}catch(r){t(r)}},a=e=>e.done?o(e.value):Promise.resolve(e.value).then(s,i);a((n=n.apply(e,r)).next())}));import{u as i,az as a}from"./index.8e60a3c0.js";import{k as c,e as l,u}from"./vue-vendor.1938e417.js";var d=(e=>(e[e.LOGIN=0]="LOGIN",e[e.REGISTER=1]="REGISTER",e[e.RESET_PASSWORD=2]="RESET_PASSWORD",e[e.MOBILE=3]="MOBILE",e[e.QR_CODE=4]="QR_CODE",e))(d||{}),g=(e=>(e.LOGIN="0",e.REGISTER="1",e.FORGET_PASSWORD="2",e))(g||{});const m=c(0);function f(){function e(e){m.value=e}return{setLoginState:e,getLoginState:l((()=>m.value)),handleBackLogin:function(){e(0)}}}function h(e){return{validForm:function(){return s(this,null,(function*(){const r=u(e);if(!r)return;return yield r.validate()}))}}}function P(e){const{t:a}=i(),c=l((()=>w(a("sys.login.accountPlaceholder")))),d=l((()=>w(a("sys.login.passwordPlaceholder")))),g=l((()=>w(a("sys.login.smsPlaceholder")))),f=l((()=>w(a("sys.login.mobilePlaceholder")))),h=l((()=>p("account"))),P=l((()=>p("mobile"))),v=(e,r)=>s(this,null,(function*(){return r?Promise.resolve():Promise.reject(a("sys.login.policyPlaceholder"))})),y=e=>(r,n)=>s(this,null,(function*(){return n?n!==e?Promise.reject(a("sys.login.diffPwd")):Promise.resolve():Promise.reject(a("sys.login.passwordPlaceholder"))}));return{getFormRules:l((()=>{const s=u(c),i=u(d),a=u(g),l=u(f),w=u(h),p=u(P),O={sms:a,mobile:l};switch(u(m)){case 1:return{account:w,password:i,mobile:p,sms:a,confirmPassword:[{validator:y(null==e?void 0:e.password),trigger:"change"}],policy:[{validator:v,trigger:"change"}]};case 2:return((e,s)=>{for(var i in s||(s={}))n.call(s,i)&&t(e,i,s[i]);if(r)for(var i of r(s))o.call(s,i)&&t(e,i,s[i]);return e})({username:s,confirmPassword:[{validator:y(null==e?void 0:e.password),trigger:"change"}]},O);case 3:return O;default:return{account:s,password:i}}}))}}function w(e){return[{required:!0,message:e,trigger:"change"}]}function p(e){return[{validator:"account"==e?v:y,trigger:"change"}]}function v(e,r,n){const{t:o}=i();return r?new Promise(((e,n)=>{a({username:r}).then((r=>{r.success?e():n("用户名已存在!")}))})):Promise.reject(o("sys.login.accountPlaceholder"))}function y(e,r,n){return s(this,null,(function*(){i();return/^1[3456789]\d{9}$/.test(r)?new Promise(((e,n)=>{a({phone:r}).then((r=>{r.success?e():n("手机号已存在!")}))})):Promise.reject(new Error("请输入正确手机号"))}))}function O(){return/wxwork|dingtalk/i.test(navigator.userAgent)}function E(e){let r=`${window._CONFIG.domianURL}/sys/thirdLogin/oauth2/${e}/login`;r+=`?state=${encodeURIComponent(window.location.origin)}`,window.location.href=r}export{d as L,g as S,P as a,h as b,O as i,E as s,f as u};
