import{t as e}from"./index.63790298.js";import{i as a}from"./vendor.ece5be17.js";import{B as t}from"./index.a6220f15.js";import{u as c,B as s}from"./useForm.0379175d.js";import"./BasicForm.vue_vue_type_style_index_0_lang.daafa440.js";import{L as r}from"./index.8e60a3c0.js";import{s as i,i as n}from"./api.5033f1c8.js";import{d as o,c as l,r as u,e as g,w as p,Y as d,a2 as m,ab as h,ad as f,f as b,u as v,a7 as y,ag as j,E as w,ac as _}from"./vue-vendor.1938e417.js";const B=o({__name:"ModalTransfer",setup(o){const[B,{validate:P,updateSchema:T,getFieldsValue:x,setFieldsValue:C}]=c();let k=l("reload");const A=u({row:{},chargeType:"2",canChargePrice:0,submitting:!1});let M=g((()=>({2:"转入",3:"转出"}[A.chargeType])));const I=g((()=>[{field:"field",component:"Input",label:`可${M.value}金额`,slot:"field"},{field:"chargePrice",component:"Input",label:`${M.value}金额`,slot:"chargePrice",rules:[{required:!0,message:`请输入${M.value}金额`,trigger:"blur"},{pattern:/^\d{0,8}(\.\d{1,3})?$/,message:"最多整数8位，小数3位！",trigger:"blur"}],componentProps:{placeholder:`请输入${M.value}金额`}}])),[O,{closeModal:R,changeOkLoading:S}]=r((function({row:e,type:a}){var t,c;Object.assign(A,{row:{},chargeType:"2",canChargePrice:0,submitting:!1}),A.row=e,A.chargeType=a,T(I.value),i({isSyncMediaBack:null==(t=A.row)?void 0:t.isSyncMediaBack,placingAccountId:null==(c=A.row)?void 0:c.placingAccountId,chargeType:A.chargeType}).then((e=>{"2"===A.chargeType?A.canChargePrice=e.objectData.mediaAccBalance||0:"3"===A.chargeType&&(A.canChargePrice=e.objectData.placingAccBalance||0)}))}));function $(){let e=[],a="0123456789abcdef";for(let t=0;t<36;t++)e[t]=a.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=a.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.splice(23,1),e.splice(18,1),e.splice(13,1),e.splice(8,1),e.join("")}p((()=>A.submitting),(e=>{S(e)}));const F=e(500,(()=>{A.submitting||(A.submitting=!0,P().then((e=>{let t=Object.assign({},{placingAccountId:A.row.placingAccountId,chargeType:A.chargeType,isSyncMediaBack:"1",randomKey:$()},e);n(t).then((e=>{a.success(e.message),R(),k()})).catch((()=>{A.submitting=!1}))})).catch((()=>{A.submitting=!1})))}));function D(){let e=x(),a=new RegExp(",","g");e.chargePrice=String(A.canChargePrice).replace(a,""),C(e)}return(e,a)=>{const c=d("a-input"),r=d("a-button"),i=d("a-input-group");return m(),h(v(t),_(e.$attrs,{title:v(M),destroyOnClose:!0,onRegister:v(O),onOk:v(F)}),{default:f((()=>[b(v(s),{onRegister:v(B),labelWidth:100,schemas:I.value,showResetButton:!1,showSubmitButton:!1,showActionButtonGroup:!1},{field:f((()=>[y("div",null,j(v(A).canChargePrice),1)])),chargePrice:f((({model:e,field:a})=>[b(i,{compact:""},{default:f((()=>[b(c,{value:e[a],"onUpdate:value":t=>e[a]=t,style:{width:"calc(100% - 88px)",height:"32px"}},null,8,["value","onUpdate:value"]),b(r,{onClick:D},{default:f((()=>[w("全部金额")])),_:1})])),_:2},1024)])),_:1},8,["onRegister","schemas"])])),_:1},16,["title","onRegister","onOk"])}}});export{B as _};
